 function dotjacobianw=dotjw(y)
global d

theta1=y(1);theta2=y(2);theta3=y(3);                                                                                                                                                                                                                                                                                                                                                        
theta4=y(4);theta5=y(5);theta6=y(6);theta7=y(7);

dtheta1=y(8);dtheta2=y(9);dtheta3=y(10);                                                                                                                                                                                                                                                                                                                                                        
dtheta4=y(11);dtheta5=y(12);dtheta6=y(13);dtheta7=y(14);
Jw= [ 0, - sin(theta7)*(sin(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) + cos(theta2)*cos(theta5)*sin(theta3)) - cos(theta7)*(cos(theta6)*(cos(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta2)*sin(theta3)*sin(theta5)) + sin(theta6)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4))),   cos(theta7)*(cos(theta6)*(cos(theta3)*sin(theta2)*sin(theta5) + cos(theta4)*cos(theta5)*sin(theta2)*sin(theta3)) - sin(theta2)*sin(theta3)*sin(theta4)*sin(theta6)) - sin(theta7)*(cos(theta3)*cos(theta5)*sin(theta2) - cos(theta4)*sin(theta2)*sin(theta3)*sin(theta5)), sin(theta5)*sin(theta7)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)) - cos(theta7)*(sin(theta6)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*cos(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))), sin(theta7)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) - cos(theta6)*cos(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3)), -cos(theta7)*(sin(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) - cos(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))),   cos(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3)) - sin(theta7)*(cos(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) + sin(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)));...
0,   sin(theta7)*(cos(theta6)*(cos(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta2)*sin(theta3)*sin(theta5)) + sin(theta6)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4))) - cos(theta7)*(sin(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) + cos(theta2)*cos(theta5)*sin(theta3)), - sin(theta7)*(cos(theta6)*(cos(theta3)*sin(theta2)*sin(theta5) + cos(theta4)*cos(theta5)*sin(theta2)*sin(theta3)) - sin(theta2)*sin(theta3)*sin(theta4)*sin(theta6)) - cos(theta7)*(cos(theta3)*cos(theta5)*sin(theta2) - cos(theta4)*sin(theta2)*sin(theta3)*sin(theta5)), sin(theta7)*(sin(theta6)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*cos(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))) + cos(theta7)*sin(theta5)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)), cos(theta7)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) + cos(theta6)*sin(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3)),  sin(theta7)*(sin(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) - cos(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))), - sin(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3)) - cos(theta7)*(cos(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) + sin(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)))];

h1=[0, 0, 0, 0, 0, 0, 0;
0, 0, 0, 0, 0, 0, 0];
h2=[0, - sin(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3)) - cos(theta7)*(cos(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) + sin(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))),   cos(theta7)*(cos(theta6)*(cos(theta2)*cos(theta3)*sin(theta5) + cos(theta2)*cos(theta4)*cos(theta5)*sin(theta3)) - cos(theta2)*sin(theta3)*sin(theta4)*sin(theta6)) - sin(theta7)*(cos(theta2)*cos(theta3)*cos(theta5) - cos(theta2)*cos(theta4)*sin(theta3)*sin(theta5)),   cos(theta7)*(sin(theta6)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta5)*cos(theta6)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4))) - sin(theta5)*sin(theta7)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4)),   cos(theta6)*cos(theta7)*(sin(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) + cos(theta2)*cos(theta5)*sin(theta3)) - sin(theta7)*(cos(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta2)*sin(theta3)*sin(theta5)),  cos(theta7)*(sin(theta6)*(cos(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta2)*sin(theta3)*sin(theta5)) - cos(theta6)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4))), sin(theta7)*(cos(theta6)*(cos(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta2)*sin(theta3)*sin(theta5)) + sin(theta6)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4))) - cos(theta7)*(sin(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) + cos(theta2)*cos(theta5)*sin(theta3));
    0,   sin(theta7)*(cos(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) + sin(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))) - cos(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3)), - cos(theta7)*(cos(theta2)*cos(theta3)*cos(theta5) - cos(theta2)*cos(theta4)*sin(theta3)*sin(theta5)) - sin(theta7)*(cos(theta6)*(cos(theta2)*cos(theta3)*sin(theta5) + cos(theta2)*cos(theta4)*cos(theta5)*sin(theta3)) - cos(theta2)*sin(theta3)*sin(theta4)*sin(theta6)), - sin(theta7)*(sin(theta6)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta5)*cos(theta6)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4))) - cos(theta7)*sin(theta5)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4)), - cos(theta7)*(cos(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta2)*sin(theta3)*sin(theta5)) - cos(theta6)*sin(theta7)*(sin(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) + cos(theta2)*cos(theta5)*sin(theta3)), -sin(theta7)*(sin(theta6)*(cos(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta2)*sin(theta3)*sin(theta5)) - cos(theta6)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4))), sin(theta7)*(sin(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) + cos(theta2)*cos(theta5)*sin(theta3)) + cos(theta7)*(cos(theta6)*(cos(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta2)*sin(theta3)*sin(theta5)) + sin(theta6)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4)))];
h3=[0,   cos(theta7)*(cos(theta6)*(cos(theta2)*cos(theta3)*sin(theta5) + cos(theta2)*cos(theta4)*cos(theta5)*sin(theta3)) - cos(theta2)*sin(theta3)*sin(theta4)*sin(theta6)) - sin(theta7)*(cos(theta2)*cos(theta3)*cos(theta5) - cos(theta2)*cos(theta4)*sin(theta3)*sin(theta5)), sin(theta7)*(cos(theta5)*sin(theta2)*sin(theta3) + cos(theta3)*cos(theta4)*sin(theta2)*sin(theta5)) - cos(theta7)*(cos(theta6)*(sin(theta2)*sin(theta3)*sin(theta5) - cos(theta3)*cos(theta4)*cos(theta5)*sin(theta2)) + cos(theta3)*sin(theta2)*sin(theta4)*sin(theta6)), - cos(theta7)*(cos(theta4)*sin(theta2)*sin(theta3)*sin(theta6) + cos(theta5)*cos(theta6)*sin(theta2)*sin(theta3)*sin(theta4)) - sin(theta2)*sin(theta3)*sin(theta4)*sin(theta5)*sin(theta7), sin(theta7)*(cos(theta3)*sin(theta2)*sin(theta5) + cos(theta4)*cos(theta5)*sin(theta2)*sin(theta3)) + cos(theta6)*cos(theta7)*(cos(theta3)*cos(theta5)*sin(theta2) - cos(theta4)*sin(theta2)*sin(theta3)*sin(theta5)), -cos(theta7)*(sin(theta6)*(cos(theta3)*sin(theta2)*sin(theta5) + cos(theta4)*cos(theta5)*sin(theta2)*sin(theta3)) + cos(theta6)*sin(theta2)*sin(theta3)*sin(theta4)), - sin(theta7)*(cos(theta6)*(cos(theta3)*sin(theta2)*sin(theta5) + cos(theta4)*cos(theta5)*sin(theta2)*sin(theta3)) - sin(theta2)*sin(theta3)*sin(theta4)*sin(theta6)) - cos(theta7)*(cos(theta3)*cos(theta5)*sin(theta2) - cos(theta4)*sin(theta2)*sin(theta3)*sin(theta5));
    0, - cos(theta7)*(cos(theta2)*cos(theta3)*cos(theta5) - cos(theta2)*cos(theta4)*sin(theta3)*sin(theta5)) - sin(theta7)*(cos(theta6)*(cos(theta2)*cos(theta3)*sin(theta5) + cos(theta2)*cos(theta4)*cos(theta5)*sin(theta3)) - cos(theta2)*sin(theta3)*sin(theta4)*sin(theta6)), sin(theta7)*(cos(theta6)*(sin(theta2)*sin(theta3)*sin(theta5) - cos(theta3)*cos(theta4)*cos(theta5)*sin(theta2)) + cos(theta3)*sin(theta2)*sin(theta4)*sin(theta6)) + cos(theta7)*(cos(theta5)*sin(theta2)*sin(theta3) + cos(theta3)*cos(theta4)*sin(theta2)*sin(theta5)),   sin(theta7)*(cos(theta4)*sin(theta2)*sin(theta3)*sin(theta6) + cos(theta5)*cos(theta6)*sin(theta2)*sin(theta3)*sin(theta4)) - cos(theta7)*sin(theta2)*sin(theta3)*sin(theta4)*sin(theta5), cos(theta7)*(cos(theta3)*sin(theta2)*sin(theta5) + cos(theta4)*cos(theta5)*sin(theta2)*sin(theta3)) - cos(theta6)*sin(theta7)*(cos(theta3)*cos(theta5)*sin(theta2) - cos(theta4)*sin(theta2)*sin(theta3)*sin(theta5)),  sin(theta7)*(sin(theta6)*(cos(theta3)*sin(theta2)*sin(theta5) + cos(theta4)*cos(theta5)*sin(theta2)*sin(theta3)) + cos(theta6)*sin(theta2)*sin(theta3)*sin(theta4)),   sin(theta7)*(cos(theta3)*cos(theta5)*sin(theta2) - cos(theta4)*sin(theta2)*sin(theta3)*sin(theta5)) - cos(theta7)*(cos(theta6)*(cos(theta3)*sin(theta2)*sin(theta5) + cos(theta4)*cos(theta5)*sin(theta2)*sin(theta3)) - sin(theta2)*sin(theta3)*sin(theta4)*sin(theta6))];

h4=[0,   cos(theta7)*(sin(theta6)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta5)*cos(theta6)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4))) - sin(theta5)*sin(theta7)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4)), - cos(theta7)*(cos(theta4)*sin(theta2)*sin(theta3)*sin(theta6) + cos(theta5)*cos(theta6)*sin(theta2)*sin(theta3)*sin(theta4)) - sin(theta2)*sin(theta3)*sin(theta4)*sin(theta5)*sin(theta7), - cos(theta7)*(sin(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)) + cos(theta5)*cos(theta6)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2))) - sin(theta5)*sin(theta7)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)), cos(theta5)*sin(theta7)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)) - cos(theta6)*cos(theta7)*sin(theta5)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)), -cos(theta7)*(cos(theta6)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + cos(theta5)*sin(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))), sin(theta7)*(sin(theta6)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*cos(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))) + cos(theta7)*sin(theta5)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4));
    0, - sin(theta7)*(sin(theta6)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta5)*cos(theta6)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4))) - cos(theta7)*sin(theta5)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4)),   sin(theta7)*(cos(theta4)*sin(theta2)*sin(theta3)*sin(theta6) + cos(theta5)*cos(theta6)*sin(theta2)*sin(theta3)*sin(theta4)) - cos(theta7)*sin(theta2)*sin(theta3)*sin(theta4)*sin(theta5),   sin(theta7)*(sin(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)) + cos(theta5)*cos(theta6)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2))) - cos(theta7)*sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)), cos(theta5)*cos(theta7)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)) + cos(theta6)*sin(theta5)*sin(theta7)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)),  sin(theta7)*(cos(theta6)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + cos(theta5)*sin(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))), cos(theta7)*(sin(theta6)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*cos(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))) - sin(theta5)*sin(theta7)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))];
h5=[0,   cos(theta6)*cos(theta7)*(sin(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) + cos(theta2)*cos(theta5)*sin(theta3)) - sin(theta7)*(cos(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta2)*sin(theta3)*sin(theta5)), sin(theta7)*(cos(theta3)*sin(theta2)*sin(theta5) + cos(theta4)*cos(theta5)*sin(theta2)*sin(theta3)) + cos(theta6)*cos(theta7)*(cos(theta3)*cos(theta5)*sin(theta2) - cos(theta4)*sin(theta2)*sin(theta3)*sin(theta5)), cos(theta5)*sin(theta7)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)) - cos(theta6)*cos(theta7)*sin(theta5)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)), - sin(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3)) - cos(theta6)*cos(theta7)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)),  cos(theta7)*sin(theta6)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3)), cos(theta7)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) + cos(theta6)*sin(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3));
    0, - cos(theta7)*(cos(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta2)*sin(theta3)*sin(theta5)) - cos(theta6)*sin(theta7)*(sin(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) + cos(theta2)*cos(theta5)*sin(theta3)), cos(theta7)*(cos(theta3)*sin(theta2)*sin(theta5) + cos(theta4)*cos(theta5)*sin(theta2)*sin(theta3)) - cos(theta6)*sin(theta7)*(cos(theta3)*cos(theta5)*sin(theta2) - cos(theta4)*sin(theta2)*sin(theta3)*sin(theta5)), cos(theta5)*cos(theta7)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)) + cos(theta6)*sin(theta5)*sin(theta7)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)),   cos(theta6)*sin(theta7)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) - cos(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3)), -sin(theta6)*sin(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3)), cos(theta6)*cos(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3)) - sin(theta7)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5))];

h6=[0,  cos(theta7)*(sin(theta6)*(cos(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta2)*sin(theta3)*sin(theta5)) - cos(theta6)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4))), -cos(theta7)*(sin(theta6)*(cos(theta3)*sin(theta2)*sin(theta5) + cos(theta4)*cos(theta5)*sin(theta2)*sin(theta3)) + cos(theta6)*sin(theta2)*sin(theta3)*sin(theta4)), -cos(theta7)*(cos(theta6)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + cos(theta5)*sin(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))),  cos(theta7)*sin(theta6)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3)), -cos(theta7)*(cos(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) + sin(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))), sin(theta7)*(sin(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) - cos(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)));
    0, -sin(theta7)*(sin(theta6)*(cos(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta2)*sin(theta3)*sin(theta5)) - cos(theta6)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4))),  sin(theta7)*(sin(theta6)*(cos(theta3)*sin(theta2)*sin(theta5) + cos(theta4)*cos(theta5)*sin(theta2)*sin(theta3)) + cos(theta6)*sin(theta2)*sin(theta3)*sin(theta4)),  sin(theta7)*(cos(theta6)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + cos(theta5)*sin(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))), -sin(theta6)*sin(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3)),  sin(theta7)*(cos(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) + sin(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))), cos(theta7)*(sin(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) - cos(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)))];

h7=[0, sin(theta7)*(cos(theta6)*(cos(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta2)*sin(theta3)*sin(theta5)) + sin(theta6)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4))) - cos(theta7)*(sin(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) + cos(theta2)*cos(theta5)*sin(theta3)), - sin(theta7)*(cos(theta6)*(cos(theta3)*sin(theta2)*sin(theta5) + cos(theta4)*cos(theta5)*sin(theta2)*sin(theta3)) - sin(theta2)*sin(theta3)*sin(theta4)*sin(theta6)) - cos(theta7)*(cos(theta3)*cos(theta5)*sin(theta2) - cos(theta4)*sin(theta2)*sin(theta3)*sin(theta5)), sin(theta7)*(sin(theta6)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*cos(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))) + cos(theta7)*sin(theta5)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)), cos(theta7)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) + cos(theta6)*sin(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3)), sin(theta7)*(sin(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) - cos(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))), - sin(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3)) - cos(theta7)*(cos(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) + sin(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)));
    0, sin(theta7)*(sin(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) + cos(theta2)*cos(theta5)*sin(theta3)) + cos(theta7)*(cos(theta6)*(cos(theta5)*(sin(theta2)*sin(theta4) + cos(theta2)*cos(theta3)*cos(theta4)) - cos(theta2)*sin(theta3)*sin(theta5)) + sin(theta6)*(cos(theta4)*sin(theta2) - cos(theta2)*cos(theta3)*sin(theta4))),   sin(theta7)*(cos(theta3)*cos(theta5)*sin(theta2) - cos(theta4)*sin(theta2)*sin(theta3)*sin(theta5)) - cos(theta7)*(cos(theta6)*(cos(theta3)*sin(theta2)*sin(theta5) + cos(theta4)*cos(theta5)*sin(theta2)*sin(theta3)) - sin(theta2)*sin(theta3)*sin(theta4)*sin(theta6)), cos(theta7)*(sin(theta6)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*cos(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))) - sin(theta5)*sin(theta7)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4)), cos(theta6)*cos(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3)) - sin(theta7)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)), cos(theta7)*(sin(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) - cos(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))),   sin(theta7)*(cos(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) + sin(theta2)*sin(theta3)*sin(theta5)) + sin(theta6)*(cos(theta2)*cos(theta4) + cos(theta3)*sin(theta2)*sin(theta4))) - cos(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) - cos(theta3)*cos(theta4)*sin(theta2)) - cos(theta5)*sin(theta2)*sin(theta3))];

dotjacobianw=h1*dtheta1+h2*dtheta2+h3*dtheta3+h4*dtheta4+h5*dtheta5+h6*dtheta6+h7*dtheta7;